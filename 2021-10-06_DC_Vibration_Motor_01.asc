Version 4
SHEET 1 3144 1140
WIRE 144 -256 -32 -256
WIRE 256 -256 144 -256
WIRE 832 -256 704 -256
WIRE 992 -256 832 -256
WIRE 1712 -256 1664 -256
WIRE 1920 -256 1712 -256
WIRE 2080 -256 1920 -256
WIRE -32 -192 -32 -256
WIRE 256 -192 256 -256
WIRE 704 -192 704 -256
WIRE 992 -192 992 -256
WIRE 1664 -176 1664 -256
WIRE 1920 -176 1920 -256
WIRE 2080 -176 2080 -256
WIRE 256 -64 256 -112
WIRE 992 -64 992 -112
WIRE -32 -32 -32 -112
WIRE 256 -32 256 -64
WIRE 704 -32 704 -112
WIRE 1664 -32 1664 -96
WIRE 1792 -32 1664 -32
WIRE 1920 -32 1920 -112
WIRE 1920 -32 1792 -32
WIRE 2080 -32 2080 -96
WIRE 2080 -32 1920 -32
WIRE 1792 32 1792 -32
WIRE 992 48 992 16
WIRE 256 80 256 48
WIRE 256 112 256 80
WIRE 992 176 992 128
WIRE 256 272 256 192
WIRE 992 272 992 256
WIRE 992 288 992 272
WIRE 1824 288 1696 288
WIRE 256 320 256 272
WIRE 1696 352 1696 288
WIRE 992 400 992 368
WIRE 992 432 992 400
WIRE 256 496 256 400
WIRE 1696 512 1696 432
WIRE 992 560 992 512
FLAG -32 -32 0
FLAG 256 496 0
FLAG 256 -64 2
FLAG 256 80 3
FLAG 256 272 4
FLAG 704 -32 0
FLAG 992 560 0
FLAG 832 -256 6
FLAG 144 -256 1
FLAG 992 272 7
FLAG 992 400 8
FLAG 1792 32 0
FLAG 1712 -256 11
FLAG 1696 512 0
SYMBOL voltage -32 -208 R0
WINDOW 3 24 44 Invisible 1
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PWL(0MS 0 50MS 0 50.1MS {drive_voltage} 150MS {drive_voltage} 150.1MS 0)
SYMATTR InstName V_drive
SYMBOL ind 240 -208 R0
SYMATTR InstName L_Motor
SYMATTR Value {L_motor}
SYMBOL res 240 -48 R0
SYMATTR InstName R_Motor
SYMATTR Value {R_motor}
SYMBOL voltage 256 304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=0
SYMATTR InstName VSENSE1
SYMATTR Value 0
SYMBOL ind 976 160 R0
SYMATTR InstName L_inertia1
SYMATTR Value {L_inertia_emass}
SYMATTR SpiceLine Rser=0 Rpar=0
SYMBOL res 976 272 R0
SYMATTR InstName R_loss
SYMATTR Value {R_loss}
SYMBOL voltage 992 416 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=0
SYMATTR InstName VSENSE2
SYMATTR Value 0
SYMBOL polcap 1904 -176 R0
SYMATTR InstName C1
SYMATTR Value 1
SYMATTR SpiceLine Rser=0 Lser=0 Rpar=0 Cpar=0
SYMBOL res 2064 -192 R0
SYMATTR InstName R1
SYMATTR Value 1
SYMBOL bv 1696 336 R0
SYMATTR InstName B1
SYMATTR Value V=.00001*I(VSENSE2)*I(VSENSE2)*sin(V(11)*57.329)
SYMBOL bv 256 96 R0
SYMATTR InstName Back_emf
SYMATTR Value V=I(VSENSE2)*K_emf
SYMBOL bv 704 -208 R0
SYMATTR InstName V_torque
SYMATTR Value V=I(VSENSE1)*K_t
SYMBOL bv 992 -208 R0
SYMATTR InstName V_gravity
SYMATTR Value V=L_inertia_emass*radius*sin(V(6))*9.81
SYMBOL ind 976 32 R0
SYMATTR InstName L_inertia
SYMATTR Value {L_inertia_rotor}
SYMATTR SpiceLine Rser=0 Rpar=0
SYMBOL bv 992 -80 R0
SYMATTR InstName V_load_torque
SYMATTR Value V=0
SYMBOL bi2 1664 -176 R0
SYMATTR InstName B3
SYMATTR Value I=I(VSENSE2)
TEXT 264 -504 Left 2 ;structure from http://www.ecircuitcenter.com/Circuits/dc_motor_model/DCmotor_model.htm\nvalues from https://www.precisionmicrodrives.com/content/ab-025-using-spice-to-model-dc-motors/\n(resistance values for inductors matter)
TEXT 8 -368 Left 2 ;Electrical Components
TEXT 648 -368 Left 2 ;Mechanical Components
TEXT -64 1048 Left 2 !.tran 0 200MS 0
TEXT 1152 192 Left 1 ;Load Polar Mass Moment of Inertia\nN m / (rad/s2) or kg m2 / rad
TEXT 1088 312 Left 1 ;Friction and Losses\nN m / (rad/s)
TEXT 808 -88 Left 1 ;Torque Constant\nN m / A
TEXT 408 -8 Left 1 ;Terminal Resistance\n(Ohm)
TEXT 408 -168 Left 1 ;Terminal Inductance\n(H)
TEXT 488 216 Left 1 ;Speed Constant\n(V/rad/s)
TEXT -56 -504 Left 2 ;DC Motor Model\nwith Eccentric Mass
TEXT -16 -272 Left 1 ;Motor Voltage (V)
TEXT 320 352 Left 1 ;I(VSENSE1) = Motor Current\n(A)
TEXT 304 72 Left 1 ;Back emf voltage (V)
TEXT 872 -272 Left 1 ;Motor Torque (N m)
TEXT -64 664 Left 2 !.param R_motor = 5.5\n.param L_motor = 50u\n.param K_t=900u\n \n.param R_loss = 300n\n.param K_emf = 900u\n \n.param L_inertia_emass = 15n\n.param L_inertia_rotor = 15n\n \n.param radius = 0.002m\n \n.param drive_voltage = 3
TEXT 352 664 Left 2 ;Motor Terminal Resistance (Ohms)\nMotor Terminal Inductance (H) \nTorque Constant (N m / A)\nPolar Mass Moment of Inertia, Motor Rotor (kg m2 / rad)\nFriction and Losses (N m / rad/s)\nSpeed Constant (V/rad/s) \n \nDrive Voltage (V)
TEXT -80 608 Left 2 ;Edit These
TEXT 1056 472 Left 1 ;I(VSENSE2) = Angular Velocity\n(rad/s)
TEXT 1704 -368 Left 2 ;Velocity to Position
TEXT 1760 -288 Left 1 ;Shaft angular position (rad)
TEXT 1696 208 Left 2 ;Velocity to Position
TEXT 1136 64 Left 1 ;Rotor Polar Mass Moment of Inertia\nN m / (rad/s2) or kg m2 / rad
TEXT -64 1096 Left 2 !.model turnoff SW(Vt = 1u Ron = 0.000001p)\n.model turn_on D( Vfwd = 0.6 Rrev = 0.0001 Ron = 0.000001)
RECTANGLE Normal 1024 1072 -80 624 2
