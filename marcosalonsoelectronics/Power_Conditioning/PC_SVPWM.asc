Version 4
SHEET 1 3780 1292
WIRE 848 -272 816 -272
WIRE -96 -256 -272 -256
WIRE 256 -256 -32 -256
WIRE 2640 -256 2048 -256
WIRE 2720 -256 2640 -256
WIRE 848 -240 816 -240
WIRE 960 -240 928 -240
WIRE 1456 -240 1408 -240
WIRE 1248 -224 1216 -224
WIRE 1280 -224 1248 -224
WIRE 848 -208 816 -208
WIRE 1280 -208 1216 -208
WIRE 1408 -208 1408 -240
WIRE 1408 -208 1344 -208
WIRE 2048 -208 2048 -256
WIRE 1264 -192 1216 -192
WIRE 1280 -192 1264 -192
WIRE 1968 -192 1952 -192
WIRE 2128 -192 2096 -192
WIRE -272 -176 -272 -256
WIRE -272 -176 -336 -176
WIRE -208 -176 -272 -176
WIRE -96 -176 -160 -176
WIRE 64 -176 -32 -176
WIRE 256 -176 112 -176
WIRE 1264 -176 1264 -192
WIRE 1280 -176 1264 -176
WIRE 1488 -176 1472 -176
WIRE 1616 -176 1552 -176
WIRE 1712 -176 1664 -176
WIRE 1968 -176 1920 -176
WIRE 2128 -176 2128 -192
WIRE 2192 -176 2128 -176
WIRE 2304 -176 2256 -176
WIRE 2512 -176 2368 -176
WIRE 848 -160 816 -160
WIRE 960 -160 928 -160
WIRE 1280 -160 1216 -160
WIRE 1248 -144 1248 -224
WIRE 1280 -144 1248 -144
WIRE 1408 -144 1408 -208
WIRE 1488 -144 1408 -144
WIRE 1616 -144 1552 -144
WIRE 1712 -144 1664 -144
WIRE 1968 -144 1952 -144
WIRE 2192 -144 2096 -144
WIRE 2352 -144 2256 -144
WIRE 2512 -144 2512 -176
WIRE 2512 -144 2416 -144
WIRE 2720 -144 2720 -256
WIRE 880 -128 816 -128
WIRE 1360 -128 1344 -128
WIRE 1968 -128 1920 -128
WIRE 2192 -112 2128 -112
WIRE 2400 -112 2256 -112
WIRE 2512 -112 2512 -144
WIRE 2512 -112 2464 -112
WIRE 1968 -96 1952 -96
WIRE 2128 -96 2128 -112
WIRE 2128 -96 2096 -96
WIRE 848 -80 816 -80
WIRE 960 -80 928 -80
WIRE 1472 -80 1472 -176
WIRE 1488 -80 1472 -80
WIRE 1616 -80 1552 -80
WIRE 1712 -80 1664 -80
WIRE 1968 -80 1920 -80
WIRE 1280 -64 1216 -64
WIRE 880 -48 816 -48
WIRE 1264 -48 1216 -48
WIRE 1280 -48 1264 -48
WIRE 1488 -48 1344 -48
WIRE 1616 -48 1552 -48
WIRE 1712 -48 1664 -48
WIRE 2320 -48 2320 -160
WIRE 2368 -48 2368 -128
WIRE 2416 -48 2416 -96
WIRE 1264 -32 1264 -48
WIRE 1280 -32 1264 -32
WIRE 1280 -16 1216 -16
WIRE 656 0 528 0
WIRE 848 0 736 0
WIRE 960 0 896 0
WIRE 1264 0 1216 0
WIRE 1280 0 1264 0
WIRE 1264 16 1264 0
WIRE 1280 16 1264 16
WIRE 1472 16 1472 -80
WIRE 1488 16 1472 16
WIRE 1616 16 1552 16
WIRE 1712 16 1664 16
WIRE 2576 16 2512 16
WIRE 1360 32 1360 -128
WIRE 1360 32 1344 32
WIRE 1488 48 1408 48
WIRE 1616 48 1552 48
WIRE 1712 48 1664 48
WIRE 2512 48 2512 16
WIRE 2576 48 2576 16
WIRE 656 64 656 32
WIRE 656 64 624 64
WIRE 688 96 688 32
WIRE 688 96 624 96
WIRE 1264 96 1216 96
WIRE 1280 96 1264 96
WIRE 1264 112 1264 96
WIRE 1280 112 1264 112
WIRE 1408 112 1408 48
WIRE 1408 112 1344 112
WIRE 1472 112 1472 16
WIRE 1504 112 1472 112
WIRE 1280 128 1216 128
WIRE 2048 128 2048 -64
WIRE 2512 128 2512 112
WIRE 2512 128 2048 128
WIRE 2608 128 2512 128
WIRE 2720 128 2720 -64
WIRE 2720 128 2608 128
WIRE -368 144 -384 144
WIRE -64 144 -256 144
WIRE 0 144 -32 144
WIRE 1264 144 1216 144
WIRE 1280 144 1264 144
WIRE 1472 144 1472 112
WIRE 240 160 64 160
WIRE 1264 160 1264 144
WIRE 1280 160 1264 160
WIRE -368 176 -736 176
WIRE -96 176 -256 176
WIRE -64 176 -64 144
WIRE 0 176 -64 176
WIRE 1280 176 1216 176
WIRE 1360 192 1360 32
WIRE 1360 192 1344 192
WIRE -384 208 -384 144
WIRE -368 208 -384 208
WIRE -96 208 -96 176
WIRE -32 208 -32 144
WIRE -32 208 -96 208
WIRE -384 240 -384 208
WIRE 1360 256 1360 192
WIRE 1360 256 1216 256
WIRE -32 304 -32 208
WIRE 0 304 -32 304
WIRE 720 304 672 304
WIRE 880 304 784 304
WIRE 992 304 960 304
WIRE 192 320 64 320
WIRE 320 320 240 320
WIRE -64 336 -64 176
WIRE 0 336 -64 336
WIRE 912 336 848 336
WIRE 672 352 672 304
WIRE 672 352 592 352
WIRE -336 384 -336 224
WIRE -336 384 -416 384
WIRE -256 384 -336 384
WIRE 672 400 672 352
WIRE 720 400 672 400
WIRE 880 400 784 400
WIRE 992 400 960 400
WIRE 848 432 848 336
WIRE 912 432 848 432
WIRE 848 480 848 432
WIRE 848 480 800 480
FLAG -256 384 wt
IOPIN -256 384 Out
FLAG 256 -256 alpha_ref
FLAG 256 -176 sector
IOPIN 256 -176 BiDir
FLAG 992 400 t2
FLAG 992 304 t1
FLAG 624 96 t2
FLAG 624 64 t1
FLAG 960 0 t0
FLAG 1504 112 fsw
FLAG 1216 -224 t0
FLAG 816 -128 t2
FLAG 1216 256 sector
IOPIN 1216 256 In
FLAG 816 -240 t1
FLAG 816 -272 t0
FLAG 816 -208 t2
FLAG 816 -48 t1
FLAG 1280 -128 0
FLAG 1280 -112 0
FLAG 960 -80 t0+1
FLAG 1216 -160 t0+1
FLAG 960 -160 t0+2
FLAG 1216 -208 t0+2
FLAG 960 -240 t0+1+2
FLAG 1280 32 0
FLAG 1280 48 0
FLAG 816 -80 t0
FLAG 816 -160 t0
FLAG 1216 -64 t0+1
FLAG 1216 -48 t0
FLAG 1216 -16 t0+2
FLAG 1216 128 t0+1
FLAG 1216 144 t0
FLAG 1216 176 t0+2
FLAG 1280 192 0
FLAG 1280 208 0
FLAG 1712 -176 c1
FLAG 1712 -48 c4
FLAG 1712 -80 c3
FLAG 1712 48 c6
FLAG 1712 16 c5
FLAG 1712 -144 c2
FLAG 2576 48 0
FLAG 2640 -256 DC+
FLAG 2608 128 DC-
FLAG 1952 -192 c1
FLAG 1920 -128 c4
FLAG 1952 -144 c3
FLAG 1920 -80 c6
FLAG 1952 -96 c5
FLAG 1920 -176 c2
FLAG -336 -176 wt
IOPIN -336 -176 In
FLAG 528 80 0
FLAG 1472 224 0
FLAG 1216 -192 t0+1+2
FLAG 1216 0 t0+1+2
FLAG 1216 96 t0+1+2
FLAG 592 352 alpha_ref
IOPIN 592 352 In
FLAG 800 480 M
IOPIN 800 480 In
FLAG 320 320 M
IOPIN 320 320 Out
FLAG 880 -208 0
FLAG 880 -272 0
FLAG 1456 -240 modulationA
IOPIN 1456 -240 BiDir
FLAG -736 256 0
FLAG 2448 -96 0
FLAG 2400 -128 0
FLAG 2352 -160 0
FLAG 2320 -48 iL1
FLAG 2368 -48 iL2
FLAG 2416 -48 iL3
FLAG 688 -32 0
FLAG 656 -32 0
FLAG -384 240 0
SYMBOL Gain -192 -176 R0
SYMATTR SpiceLine G={3/pi}
SYMATTR InstName U8
SYMBOL Gain 864 0 R0
WINDOW 39 -29 29 Left 2
SYMATTR SpiceLine G=0.5
SYMATTR InstName U21
SYMATTR SpiceLine2 db=0  Rout=1 cout=1n
SYMBOL Lim 96 -176 R0
WINDOW 39 -6 29 Center 2
SYMATTR SpiceLine Min=0 Max=6
SYMATTR InstName U24
SYMBOL DeadTime 1648 -176 R0
WINDOW 40 -8 24 Invisible 2
SYMATTR SpiceLine2 dt=dt td=dt
SYMATTR InstName U28
SYMBOL Digital\\diffschmitt 1488 -224 R0
WINDOW 0 22 30 Left 2
SYMATTR InstName A3
SYMATTR SpiceLine vt=0 vh={vh} td={td}
SYMBOL MUX 1312 -160 R0
SYMATTR InstName U37
SYMATTR Value Cout=11n
SYMBOL 3ph_br_vm 2032 -128 R0
SYMATTR InstName U40
SYMATTR SpiceLine Ron=100m Roff=10Meg Vfwd=1
SYMATTR SpiceLine2 Rs=10meg Cs=1n
SYMBOL Math1 -64 -176 R0
SYMATTR SpiceModel ceil
SYMATTR InstName U2
SYMBOL Math1 752 400 R0
WINDOW 40 0 28 Center 2
SYMATTR SpiceModel sin
SYMATTR InstName U9
SYMBOL Math1 752 304 R0
WINDOW 40 -2 34 Center 2
SYMATTR SpiceLine2 phi={2*pi/3}
SYMATTR SpiceModel sin
SYMATTR InstName U11
SYMBOL Math2 32 320 R0
SYMATTR SpiceModel hypot
SYMATTR InstName U19
SYMBOL Math2 32 160 R0
WINDOW 39 66 47 Center 2
SYMATTR SpiceLine a=-1 b=-1 dc={pi}
SYMATTR InstName U20
SYMBOL voltage 528 -16 M0
WINDOW 0 38 63 Left 2
WINDOW 3 34 86 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 34 108 Left 2
SYMATTR InstName V3
SYMATTR Value 1
SYMBOL voltage 1472 128 R0
WINDOW 0 23 104 Left 2
WINDOW 3 -86 132 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 -86 154 Left 2
SYMATTR InstName V4
SYMATTR Value PULSE(0 1 0 {.5/fsw} {.5/fsw} 0 {1/fsw})
SYMATTR SpiceLine Rser=1 Cpar=1n
SYMBOL Math2r 880 -160 R0
SYMATTR SpiceModel +
SYMATTR InstName U10
SYMBOL Math2r 880 -80 R0
SYMATTR SpiceModel +
SYMATTR InstName U13
SYMBOL Math2r 912 304 R0
SYMATTR SpiceModel x
SYMATTR InstName U5
SYMBOL Math2r 912 400 R0
SYMATTR SpiceModel x
SYMATTR InstName U6
SYMBOL Math1 -64 -256 R0
WINDOW 39 0 28 Center 2
SYMATTR SpiceLine y={pi/3}
SYMATTR SpiceModel mod1
SYMATTR InstName U3
SYMBOL DeadTime 1648 -144 R0
WINDOW 40 -8 24 Invisible 2
SYMATTR SpiceLine2 dt=dt td=dt
SYMATTR InstName U7
SYMBOL DeadTime 1648 -80 R0
WINDOW 40 -8 24 Invisible 2
SYMATTR SpiceLine2 dt=dt td=dt
SYMATTR InstName U31
SYMBOL DeadTime 1648 -48 R0
WINDOW 40 -8 24 Invisible 2
SYMATTR SpiceLine2 dt=dt td=dt
SYMATTR InstName U32
SYMBOL DeadTime 1648 16 R0
WINDOW 40 -8 24 Invisible 2
SYMATTR SpiceLine2 dt=dt td=dt
SYMATTR InstName U33
SYMBOL DeadTime 1648 48 R0
WINDOW 40 -8 24 Invisible 2
SYMATTR SpiceLine2 dt=dt td=dt
SYMATTR InstName U34
SYMBOL voltage 2720 -160 R0
WINDOW 0 23 104 Left 2
WINDOW 3 27 131 Left 2
WINDOW 39 18 159 Left 2
WINDOW 40 21 182 Left 2
SYMATTR InstName V1
SYMATTR Value 565
SYMATTR SpiceLine Rser=0.1
SYMATTR SpiceLine2 Cpar=1m
SYMBOL voltage -736 160 R0
WINDOW 0 -6 -9 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 30 86 Left 2
WINDOW 3 41 65 Left 2
SYMATTR InstName V2
SYMATTR SpiceLine Rser=1 Cpar=10u
SYMATTR Value pulse -0.3 -0.6 23.45m 1u
SYMBOL Isense 2432 -112 R0
SYMATTR SpiceLine G={1/kc} cout=3n
SYMATTR InstName U16
SYMBOL MUX 1312 0 R0
SYMATTR InstName U1
SYMATTR Value Cout=12n
SYMBOL MUX 1312 160 R0
SYMATTR InstName U29
SYMATTR Value Cout=9n
SYMBOL Math5 880 -240 R0
SYMATTR InstName U4
SYMBOL Digital\\diffschmitt 1488 -32 R0
WINDOW 0 22 30 Left 2
SYMATTR InstName A1
SYMATTR SpiceLine vt=0 vh={vh} td={td}
SYMBOL Digital\\diffschmitt 1488 -128 R0
WINDOW 0 22 30 Left 2
SYMATTR InstName A2
SYMATTR SpiceLine vt=0 vh={vh} td={td}
SYMBOL cap 2496 48 R0
SYMATTR InstName C1
SYMATTR Value 1n
SYMATTR SpiceLine Rser=1 Rpar=1meg
SYMBOL Math5 688 0 R0
SYMATTR InstName U30
SYMATTR SpiceModel +++--
SYMBOL Isense 2336 -176 R0
SYMATTR SpiceLine G={1/kc} cout=1n
SYMATTR InstName U12
SYMBOL Isense 2384 -144 R0
SYMATTR SpiceLine G={1/kc} cout=2n
SYMATTR InstName U14
SYMBOL Lim 224 320 R0
WINDOW 39 -6 29 Center 2
SYMATTR SpiceLine Min=0 Max=1
SYMATTR InstName U26
SYMBOL Transforms -320 176 R0
SYMATTR InstName U27
SYMATTR SpiceModel dq/AB
SYMBOL wt -432 384 R0
SYMATTR SpiceLine f={f} phi={-pi/2}
SYMATTR InstName U15
SYMBOL 3ph_LC 2224 -144 R0
WINDOW 39 -36 -75 Left 2
SYMATTR SpiceLine L=50m C=1n RLser=10 RLpar=10k
SYMATTR SpiceLine2 null=0 k=0
SYMATTR InstName U17
TEXT 1840 -384 Left 2 !.tran 50m
TEXT 1840 -336 Left 2 !.param f=50 fsw=2k dt=1u kc=10
TEXT -872 40 Left 2 ;The step in the amplitude of the reference\nis to show the behaviour under transients.
TEXT -408 -104 Left 2 ;The angle, wt, is used to generate the\nsector values and the reference angle,\nalpha, <0:pi/3>, which, in turn, is further\nused to calculate the timings.
TEXT 432 448 Left 2 ;From alpha:\nT1=M*sin(pi/3-alpha)\nT2=M*sin(alpha)
TEXT 424 144 Left 2 ;From T1 and T2:\nT0=Ts-T1-T2\nThe other angles serve the modulation.
TEXT 1088 416 Left 2 ;The sectors control the timing waveforms according to the\nsymmetrical SVM case, the one used here. Afterwards, the\nsignals, modulated with the third harmonic is fed to the\nPWM comparators.
TEXT 1848 424 Left 2 ;A overly-simplified motor as load, modelled by a series RL and a voltage source as a\nback-EMF. Notice, though, the larger response time, as opposed to PC_SVHCC\nschematic, but also how smooth the ripple is in comparison. The switching\nfrequency is chosen 5.5kHz, similar to the average of the one in PC_SVHCC.
TEXT 976 -432 Center 5 ;Space-Vector Pulse-Width Modulation
TEXT 952 -376 Center 2 ;(open loop)
TEXT 1840 -448 Left 2 ;(it may need the alternate solver; if not, simply\npress ESC when it's doing the "damped analysis")
TEXT 1584 136 Left 2 !.param vh=10m td=1u
RECTANGLE Normal 1056 528 416 240 2
RECTANGLE Normal 1056 224 416 -304 2
RECTANGLE Normal 400 528 -880 16 2
RECTANGLE Normal 1824 528 1072 -304 2
RECTANGLE Normal 2864 528 1840 -304 2
RECTANGLE Normal 400 0 -416 -304 2
